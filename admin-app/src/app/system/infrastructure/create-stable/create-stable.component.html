<div>

    <div class="page-title">
        <h2> Добавить конюшню </h2>
    </div>

    <form [formGroup]="stableForm">

        <section class="section">
            <h3>Основное</h3>

            <div class="input-block">
                <label class="input-label">Тип конюшни</label>
                <p-dropdown [options]="stableTypes" optionLabel="title" optionValue="id" formControlName="type">
                </p-dropdown>
                <p-dropdown [options]="material" optionLabel="title" optionValue="id" formControlName="material">
                </p-dropdown>
            </div>

            <div class="input-block">
                <label class="input-label">Постояльцы</label>
                <p-dropdown [options]="stableTypesP" optionLabel="title" optionValue="id" formControlName="type">
                </p-dropdown>
            </div>

            <div class="input-block">
                <label class="input-label">Ширина прохода</label>
                <span class="p-float-label">
                    <p-inputNumber formControlName="bal" mode="decimal">
                    </p-inputNumber>
                    <label for="inputtext">ширина</label>
                </span>
            </div>

            <div class="input-block">
                <label class="input-label">Типы денников</label>

                <div class="stalls" formArrayName="stalls">
                    <div class="input-stall-block"
                        *ngFor="let item of stableForm.controls.stalls['controls']; let i=index" [formGroupName]="i">

                        <span class="p-float-label">
                            <p-inputNumber formControlName="length" mode="decimal">
                            </p-inputNumber>
                            <label for="inputtext">длина</label>
                        </span>

                        <span class="p-float-label">
                            <p-inputNumber formControlName="width" mode="decimal">
                            </p-inputNumber>
                            <label for="inputtext">ширина</label>
                        </span>

                        <span class="p-float-label">
                            <p-inputNumber formControlName="amount" mode="decimal">
                            </p-inputNumber>
                            <label for="inputtext">количество</label>
                        </span>

                        <button *ngIf="i == stableForm.controls.stalls['controls'].length-1" pButton pRipple
                            type="button" icon="pi pi-plus" class="p-button-rounded p-button-text"
                            (click)="addStallType()"></button>

                        <button *ngIf="i != stableForm.controls.stalls['controls'].length-1" pButton pRipple
                            type="button" icon="pi pi-minus" class="p-button-rounded p-button-text"
                            (click)="deleteStallType(i)"></button>
                    </div>
                </div>
            </div>
        </section>



        <section class="section">
            <h3>Фотографии КСК</h3>
            <div class="images-input">
                <p-fileUpload name="demo[]" [multiple]="true" [showUploadButton]="false" [showCancelButton]="false"
                    url="./upload.php" accept="image/*" (onUpload)="onBasicUpload($event)"></p-fileUpload>
            </div>
        </section>

        <section class="section">
            <h3>Оснащение КСК</h3>
            <div class="card">
                <p-table [value]="customers" dataKey="title">
                    <ng-template pTemplate="header">
                        <tr>
                            <th colspan="1"></th>
                            <th colspan="6" style="text-align:center"></th>
                            <th colspan="1" style="text-align:center">Наличие</th>
                            <th colspan="2" style="text-align:center">Фото</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowIndex="rowIndex" let-customer let-expanded="expanded">
                        <tr *ngIf="rowGroupMetadata[customer.groupTitle].index === rowIndex">
                            <td colspan="10">
                                <h3>{{customer.groupTitle}}</h3>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <button type="button" pButton pRipple [pRowToggler]="customer"
                                    class="p-button-text p-button-rounded p-button-plain"
                                    [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'" [disabled]="!customer.withPhoto"></button>
                            </td>
                            <td colspan="6">
                                {{customer.title}}
                            </td>
                            <td style="text-align:center">
                                <p-checkbox [formControlName]=customer.formControlName></p-checkbox>
                            </td>
                            <td colspan="2" style="text-align:center">
                                <p *ngIf="customer.withPhoto">не загружено</p>
                            </td>
                        </tr>
                    </ng-template>

                    <ng-template pTemplate="rowexpansion" let-customer>
                        <tr>
                            <td colspan="10">   
                                <div class="p-p-3">
                                    <p-fileUpload name="demo[]" [multiple]="false" [showUploadButton]="false"
                                        [showCancelButton]="false" url="./upload.php" accept="image/*"
                                        (onUpload)="onBasicUpload($event)"></p-fileUpload>
                                </div>
                            </td>
                        </tr>
                    </ng-template>

                </p-table>
            </div>
        </section>
    </form>
</div>